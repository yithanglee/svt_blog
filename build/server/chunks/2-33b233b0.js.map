{"version":3,"file":"2-33b233b0.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(main)/_layout.js","../../../.svelte-kit/adapter-node/nodes/2.js"],"sourcesContent":["import { s as session } from \"../../../chunks/session.js\";\nimport Cookies from \"js-cookie\";\nimport { b as PHX_COOKIE, P as PHX_HTTP_PROTOCOL, a as PHX_ENDPOINT } from \"../../../chunks/constants.js\";\nimport \"../../../chunks/index.js\";\nimport { i as isToastOpen } from \"../../../chunks/toast.js\";\nasync function load({ locals }) {\n  console.log(\"check if this load 1\");\n  console.log(locals);\n  let app_routes = [], user = { username: \"Guest\" }, needLogin = false;\n  function relogin() {\n    session.logout();\n    Cookies.remove(\"user\");\n    Cookies.remove(PHX_COOKIE);\n    needLogin = true;\n  }\n  let cookieToken = await Cookies.get(PHX_COOKIE);\n  console.log(\"from main layout js\");\n  console.log(cookieToken);\n  console.log(session.user());\n  if (cookieToken != null) {\n    const response = await fetch(PHX_HTTP_PROTOCOL + PHX_ENDPOINT + \"/svt_api/webhook?scope=get_cookie_user&cookie=\" + cookieToken, {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    if (response.ok) {\n      let res = await response.json();\n      console.log(res);\n      if (res != null) {\n        session.login({\n          username: res.user.username,\n          token: cookieToken,\n          role_app_routes: res.user.role.app_routes,\n          id: res.user_id\n        });\n        app_routes = res.user.role.app_routes;\n        user = res.user;\n      } else {\n        relogin();\n        isToastOpen.notify(\"Close this window and re login!\");\n      }\n    } else {\n      relogin();\n      isToastOpen.notify(\"Close this window and re login!\");\n    }\n  } else {\n    relogin();\n    isToastOpen.notify(\"Close this window and re login!\");\n  }\n  return {\n    app_routes,\n    user,\n    needLogin\n  };\n}\nexport {\n  load\n};\n","import * as universal from '../entries/pages/(main)/_layout.js';\n\nexport const index = 2;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/(main)/_layout.svelte.js')).default;\nexport { universal };\nexport const universal_id = \"src/routes/(main)/+layout.js\";\nexport const imports = [\"_app/immutable/nodes/2.99e89759.js\",\"_app/immutable/chunks/session.608d4848.js\",\"_app/immutable/chunks/singletons.c44d92ae.js\",\"_app/immutable/chunks/scheduler.a278e30b.js\",\"_app/immutable/chunks/js.cookie.c4425e19.js\",\"_app/immutable/chunks/index.bc19f21f.js\",\"_app/immutable/chunks/Icon.c81b812b.js\",\"_app/immutable/chunks/Indicator.svelte_svelte_type_style_lang.7922a51a.js\",\"_app/immutable/chunks/index.0132ad10.js\",\"_app/immutable/chunks/stores.398c5acc.js\",\"_app/immutable/chunks/pageTitle.95703803.js\",\"_app/immutable/chunks/Button.4181d088.js\"];\nexport const stylesheets = [\"_app/immutable/assets/Indicator.1d121e74.css\"];\nexport const fonts = [];\n"],"names":[],"mappings":"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"}