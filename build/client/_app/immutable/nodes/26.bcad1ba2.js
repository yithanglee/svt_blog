import{s as R,f as M,a as Y,g as O,E as X,c as j,j as z,k as P,i as b,N as C,d as k,o as A}from"../chunks/scheduler.a278e30b.js";import{S as B,i as V}from"../chunks/index.bc19f21f.js";import{a as S}from"../chunks/index.0132ad10.js";import{b as F,c as G}from"../chunks/js.cookie.c4425e19.js";async function J(){return{}}const D=Object.freeze(Object.defineProperty({__proto__:null,load:J},Symbol.toStringTag,{value:"Module"}));function K(_){let l,v="Placement tree",h,s,u='<canvas id="binaryTreeCanvas" width="1200" height="2600"></canvas>';return{c(){l=M("div"),l.textContent=v,h=Y(),s=M("div"),s.innerHTML=u,this.h()},l(n){l=O(n,"DIV",{class:!0,"data-svelte-h":!0}),X(l)!=="svelte-bnnkqb"&&(l.textContent=v),h=j(n),s=O(n,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),X(s)!=="svelte-15nnqdt"&&(s.innerHTML=u),this.h()},h(){z(l,"class","p-2"),z(s,"class","text-center"),P(s,"height","900px"),P(s,"width","100vw"),P(s,"overflow","scroll")},m(n,t){b(n,l,t),b(n,h,t),b(n,s,t)},p:C,i:C,o:C,d(n){n&&(k(l),k(h),k(s))}}}function Q(_,l,v){let{data:h}=l;var s=[],u,n,t;async function E(e){const i=n.getBoundingClientRect(),r=e.clientX-i.left,c=e.clientY-i.top;s.forEach(a=>{var o=10;a.level>-3?o=40:a.level>-5?o=25:a.level>-10&&(o=20),r>=a.x-o&&r<=a.x+o&&c>=a.y-o&&c<=a.y+o&&a.name!="~空"&&(console.log("Node clicked:",a.name),u==a.name?(u=a.name,S(T,{scope:"placement",username:"first",full:!0}).then(m=>{w(m)})):(u=a.name,S(T,{scope:"placement",username:a.name,full:!0}).then(m=>{w(m)})))})}function H(e){t.beginPath();var i=10,r=10;e.level>-3?i=40:e.level>-5?(r=2,i=25):e.level>-10&&(r=0,i=20),t.arc(e.x,e.y,i,0,2*Math.PI),t.fillStyle="#009688",t.fill(),t.stroke(),t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI),t.fillStyle="#009688",t.fill(),t.fillStyle="white",t.font="16px Arial",t.fillText(e.name,e.x+r-i,e.y+5)}function N(e,i){H(e),i.name!="~空"&&(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.stroke(),H(i))}function I(e,i,r,c,a,o){class m{constructor(d,f,g,x,y,q){this.level=q,this.id=d,this.name=f,this.position=g,this.x=x,this.y=y,this.children=[]}}if(!e)return;const p=new m(e.id,e.name,e.position,i,r,c);return s.push(p),e.children!=null&&e.children.forEach((L,d)=>{var f=2**c;c>-2?f=2:c>-5?f=1:c>-8?f=3:c>-12?f=4:c>-18&&(f=5);const g=i+(d-(e.children.length-1)/2)*a*f,x=r+80;console.log("level "+c+", index "+d+" factor "+f),console.log([g,x]);const y=I(L,g,x,c-1,a/2);N(p,y),p.children.push(y)}),p}var T=F+G;A(async()=>{n=document.getElementById("binaryTreeCanvas"),t=n.getContext("2d");var e=await S(T,{scope:"placement",username:"first",full:!0});w(e)});function w(e){console.log(e),n.removeEventListener("click",E),s=[],t.clearRect(0,0,n.width,n.height);const i=200;I(e,n.width/2,30,0,i),n.addEventListener("click",E)}return _.$$set=e=>{"data"in e&&v(0,h=e.data)},[h]}class ee extends B{constructor(l){super(),V(this,l,Q,K,R,{data:0})}}export{ee as component,D as universal};
