import{P as k}from"../chunks/constants.387862d7.js";import{s as x,a as y,f as T,c as I,g as B,h as D,d as f,i as g,G as F,o as L,W as U,l as C,m as M,k as q,j as A,N as J}from"../chunks/scheduler.f417f79b.js";import{S as z,i as G,b as _,d as h,m as b,a as v,t as S,e as w}from"../chunks/index.8ede18d1.js";import{S as H}from"../chunks/phoenix.4c184a8e.js";import{B as O}from"../chunks/Button.6dee57fd.js";import"../chunks/Indicator.svelte_svelte_type_style_lang.7922a51a.js";import{T as R,a as W}from"../chunks/Tabs.90c08209.js";async function X(){return console.log(k),{endpoint:k}}const me=Object.freeze(Object.defineProperty({__proto__:null,load:X},Symbol.toStringTag,{value:"Module"}));function K(c){let e;return{c(){e=T("video"),this.h()},l(n){e=B(n,"VIDEO",{style:!0,id:!0}),D(e).forEach(f),this.h()},h(){q(e,"width","100%"),A(e,"id","local-stream"),e.autoplay=!0,e.muted=!0},m(n,t){g(n,e,t)},p:J,d(n){n&&f(e)}}}function Q(c){let e,n;return e=new W({props:{open:!0,title:"Local",$$slots:{default:[K]},$$scope:{ctx:c}}}),{c(){_(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,a){b(e,t,a),n=!0},p(t,a){const l={};a&16777216&&(l.$$scope={dirty:a,ctx:t}),e.$set(l)},i(t){n||(v(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Y(c){let e;return{c(){e=C("Connect")},l(n){e=M(n,"Connect")},m(n,t){g(n,e,t)},d(n){n&&f(e)}}}function Z(c){let e;return{c(){e=C("Stop")},l(n){e=M(n,"Stop")},m(n,t){g(n,e,t)},d(n){n&&f(e)}}}function ee(c){let e,n,t,a,l,i,u;return e=new R({props:{$$slots:{default:[Q]},$$scope:{ctx:c}}}),a=new O({props:{$$slots:{default:[Y]},$$scope:{ctx:c}}}),a.$on("click",c[3]),i=new O({props:{$$slots:{default:[Z]},$$scope:{ctx:c}}}),i.$on("click",c[4]),{c(){_(e.$$.fragment),n=y(),t=T("section"),_(a.$$.fragment),l=y(),_(i.$$.fragment)},l(o){h(e.$$.fragment,o),n=I(o),t=B(o,"SECTION",{});var s=D(t);h(a.$$.fragment,s),l=I(s),h(i.$$.fragment,s),s.forEach(f)},m(o,s){b(e,o,s),g(o,n,s),g(o,t,s),b(a,t,null),F(t,l),b(i,t,null),u=!0},p(o,[s]){const d={};s&16777216&&(d.$$scope={dirty:s,ctx:o}),e.$set(d);const $={};s&16777216&&($.$$scope={dirty:s,ctx:o}),a.$set($);const p={};s&16777216&&(p.$$scope={dirty:s,ctx:o}),i.$set(p)},i(o){u||(v(e.$$.fragment,o),v(a.$$.fragment,o),v(i.$$.fragment,o),u=!0)},o(o){S(e.$$.fragment,o),S(a.$$.fragment,o),S(i.$$.fragment,o),u=!1},d(o){o&&(f(n),f(t)),w(e,o),w(a),w(i)}}}function te(c,e){c.srcObject=e}function ne(c,e,n){let{data:t}=e,a;document.getElementById("videoInput"),document.getElementById("localMusicVideo");let l;new MediaStream;let i,u=0,o=!0,s,d=!1;async function $(){o=!1,l=document.getElementById("local-stream");var r=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0,width:{ideal:1920},height:{ideal:1080}});if(te(l,r),d){console.log("joined");let m=document.createElement("canvas");m.width=800,m.height=600;const E=m.getContext("2d"),j=()=>{setTimeout(()=>{u=u+1,console.log(u),E.drawImage(l,0,0,m.width,m.height);const V=m.toDataURL("image/jpeg");o==!1&&a.push("frame",{data:V}),s=requestAnimationFrame(j)},2e3)};j()}else console.log("not join yet")}const p=()=>{cancelAnimationFrame(s),o=!0;const r=l.srcObject;r&&(r.getTracks().forEach(m=>m.stop()),l.srcObject=null)};L(()=>{l=document.getElementById("local-stream"),i=t.endpoint;const r=new H("ws://"+i+"/socket");r.connect();var m="support:lobby";a=r.channel(m,{}),a.join().receive("ok",E=>{d=!0,console.log("Joined topic",m)}).receive("error",E=>{console.log("Unable to join topic",m)})}),U(()=>{a&&a.leave().receive("ok",r=>{console.log("Left the channel",r)}).receive("error",r=>{console.log("Error leaving the channel",r)})});const P=()=>{$()},N=()=>{p()};return c.$$set=r=>{"data"in r&&n(2,t=r.data)},[$,p,t,P,N]}class ue extends z{constructor(e){super(),G(this,e,ne,ee,x,{data:2})}}export{ue as component,me as universal};
