import{a as f,P as d,g as y,i as c,b as m,c as h}from"./js.cookie.c4425e19.js";async function b(o,t){let e,s=f.get(d),a=s??"empty";var r={method:"POST",endpoint:m+h};let i={Authorization:`Basic ${a}`,"Content-Type":"application/json"};t.isFormData!=null&&delete i["Content-Type"];const l={method:t.method!=null?t.method:"POST",headers:i,body:t.isFormData!=null?o:JSON.stringify(o)};console.info(l);try{const n=await fetch(t.endpoint!=null?t.endpoint:r.endpoint,l);if(console.log(),n.status==403&&(f.remove(d),y("/")),n.ok)e=await n.json(),console.log(e),e.status!=null?e.status=="ok"?c.notify("Submitted succesfully!"):e.status=="error"&&e.reason!=null&&c.notify("Error! "+e.reason):c.notify("Submitted succesfully!"),t.successCallback!=null&&t.successCallback();else{c.notify("Not Submitted!");let u="Failed to post data."}}catch(n){console.error(n),c.notify("Error!")}return e}function p(o,t=null){return Object.keys(o).map(e=>{const s=t?`${t}[${encodeURIComponent(e)}]`:encodeURIComponent(e);return o[e]!=null&&typeof o[e]=="object"&&!Array.isArray(o[e])?p(o[e],s):o[e]==null?"":`${s}=${encodeURIComponent(o[e])}`}).join("&")}async function O(o,t){let e=[];const a=p({scope:"gen_inputs",module:t}),r=await fetch(o+`/svt_api/webhook?${a}`,{headers:{"Content-Type":"application/json"}});if(r.ok){let i=await r.json(),l=Object.keys(i);return l.sort((n,u)=>n.localeCompare(u)),l.forEach((n,u)=>{e.push({key:n,value:i[n]})}),console.log(e),e}else return console.error("API request failed"),[]}async function C(o,t){const s=p(t),a=await fetch(o+`/svt_api/webhook?${s}`,{headers:{"Content-Type":"application/json"}});return a.ok?await a.json():(console.error("API request failed"),[])}export{C as a,p as b,O as g,b as p};
